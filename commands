#Login to UPPMAX
ssh -AX sarasl@rackham.uppmax.uu.se

#Create directories
mkdir git
cd git 
git clone https://github.com/Sara-SL/GenomeAnalysis.git
cd GenomeAnalysis
mkdir Data
cd Data
mkdir wgs_data
mkdir rna_seq_data
cd rna_seq_data
mkdir raw
mkdir trimmed


#Rename Data
cd GenomeAnalysis/Data/wgs_data
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/wgs_data/sel4_SRR5819794.trim_1P.fastq.gz bat_400.trim_1P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/wgs_data/sel4_SRR5819794.trim_1U.fastq.gz bat_400.trim_1U.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/wgs_data/sel4_SRR5819794.trim_2P.fastq.gz bat_400.trim_2P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/wgs_data/sel4_SRR5819794.trim_2U.fastq.gz bat_400.trim_2U.fastq.gz

ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/wgs_data/sel4_SRR5819795.trim_1P.fastq.gz bat_800.trim_1P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/wgs_data/sel4_SRR5819795.trim_1U.fastq.gz bat_800.trim_1U.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/wgs_data/sel4_SRR5819795.trim_2P.fastq.gz bat_800.trim_2P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/wgs_data/sel4_SRR5819795.trim_2U.fastq.gz bat_800.trim_2U.fastq.gz

ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/wgs_data/sel4_SRR5819796.trim_1P.fastq.gz bat_8to10kb.trim_1P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/wgs_data/sel4_SRR5819796.trim_1U.fastq.gz bat_8to10kb.trim_1U.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/wgs_data/sel4_SRR5819796.trim_2P.fastq.gz bat_8to10kb.trim_2P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/wgs_data/sel4_SRR5819796.trim_2U.fastq.gz bat_8to10kb.trim_2U.fastq.gz

ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/wgs_data/sel4_SRR5819797.trim_1P.fastq.gz bat_175.trim_1P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/wgs_data/sel4_SRR5819797.trim_1U.fastq.gz bat_175.trim_1U.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/wgs_data/sel4_SRR5819797.trim_2P.fastq.gz bat_175.trim_2P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/wgs_data/sel4_SRR5819797.trim_2U.fastq.gz bat_175.trim_2U.fastq.gz

ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/wgs_data/sel4_SRR5819798.trim_1P.fastq.gz bat_2to4kb.trim_1P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/wgs_data/sel4_SRR5819798.trim_1U.fastq.gz bat_2to4kb.trim_1U.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/wgs_data/sel4_SRR5819798.trim_2P.fastq.gz bat_2to4kb.trim_2P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/wgs_data/sel4_SRR5819798.trim_2U.fastq.gz bat_2to4kb.trim_2U.fastq.gz

ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/wgs_data/sel4_SRR5819799.trim_1P.fastq.gz bat_5to6kb.trim_1P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/wgs_data/sel4_SRR5819799.trim_1U.fastq.gz bat_5to6kb.trim_1U.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/wgs_data/sel4_SRR5819799.trim_2P.fastq.gz bat_5to6kb.trim_2P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/wgs_data/sel4_SRR5819799.trim_2U.fastq.gz bat_5to6kb.trim_2U.fastq.gz

cd ../rna_seq_data/raw
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/raw/sel4_SRR1719266.1.fastq.gz HL_CS17_45.1.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/raw/sel4_SRR1719266.2.fastq.gz HL_CS17_45.2.fastq.gz

cd ../trimmed
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719013.trim_1P.fastq.gz FL_CS15_13.trim_1P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719013.trim_1U.fastq.gz FL_CS15_13.trim_1U.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719013.trim_2P.fastq.gz FL_CS15_13.trim_2P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719013.trim_2U.fastq.gz FL_CS15_13.trim_2U.fastq.gz

ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719014.trim_1P.fastq.gz FL_CS15_16.trim_1P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719014.trim_1U.fastq.gz FL_CS15_16.trim_1U.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719014.trim_2P.fastq.gz FL_CS15_16.trim_2P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719014.trim_2U.fastq.gz FL_CS15_16.trim_2U.fastq.gz

ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719015.trim_1P.fastq.gz FL_CS15_58.trim_1P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719015.trim_1U.fastq.gz FL_CS15_58.trim_1U.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719015.trim_2P.fastq.gz FL_CS15_58.trim_2P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719015.trim_2U.fastq.gz FL_CS15_58.trim_2U.fastq.gz

ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719016.trim_1P.fastq.gz HL_CS15_13.trim_1P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719016.trim_1U.fastq.gz HL_CS15_13.trim_1U.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719016.trim_2P.fastq.gz HL_CS15_13.trim_2P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719016.trim_2U.fastq.gz HL_CS15_13.trim_2U.fastq.gz

ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719017.trim_1P.fastq.gz HL_CS15_16.trim_1P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719017.trim_1U.fastq.gz HL_CS15_16.trim_1U.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719017.trim_2P.fastq.gz HL_CS15_16.trim_2P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719017.trim_2U.fastq.gz HL_CS15_16.trim_2U.fastq.gz

ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719018.trim_1P.fastq.gz HL_CS15_58.trim_1P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719018.trim_1U.fastq.gz HL_CS15_58.trim_1U.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719018.trim_2P.fastq.gz HL_CS15_58.trim_2P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719018.trim_2U.fastq.gz HL_CS15_58.trim_2U.fastq.gz

ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719204.trim_1P.fastq.gz FL_CS16_21.trim_1P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719204.trim_1U.fastq.gz FL_CS16_21.trim_1U.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719204.trim_2P.fastq.gz FL_CS16_21.trim_2P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719204.trim_2U.fastq.gz FL_CS16_21.trim_2U.fastq.gz

ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719206.trim_1P.fastq.gz FL_CS16_43.trim_1P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719206.trim_1U.fastq.gz FL_CS16_43.trim_1U.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719206.trim_2P.fastq.gz FL_CS16_43.trim_2P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719206.trim_2U.fastq.gz FL_CS16_43.trim_2U.fastq.gz

ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719207.trim_1P.fastq.gz FL_CS16_49.trim_1P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719207.trim_1U.fastq.gz FL_CS16_49.trim_1U.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719207.trim_2P.fastq.gz FL_CS16_49.trim_2P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719207.trim_2U.fastq.gz FL_CS16_49.trim_2U.fastq.gz

ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719208.trim_1P.fastq.gz FL_CS17_33.trim_1P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719208.trim_1U.fastq.gz FL_CS17_33.trim_1U.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719208.trim_2P.fastq.gz FL_CS17_33.trim_2P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719208.trim_2U.fastq.gz FL_CS17_33.trim_2U.fastq.gz

ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719209.trim_1P.fastq.gz FL_CS17_42.trim_1P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719209.trim_1U.fastq.gz FL_CS17_42.trim_1U.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719209.trim_2P.fastq.gz FL_CS17_42.trim_2P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719209.trim_2U.fastq.gz FL_CS17_42.trim_2U.fastq.gz

ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719211.trim_1P.fastq.gz FL_CS17_45.trim_1P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719211.trim_1U.fastq.gz FL_CS17_45.trim_1U.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719211.trim_2P.fastq.gz FL_CS17_45.trim_2P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719211.trim_2U.fastq.gz FL_CS17_45.trim_2U.fastq.gz

ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719212.trim_1P.fastq.gz HL_CS16_21.trim_1P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719212.trim_1U.fastq.gz HL_CS16_21.trim_1U.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719212.trim_2P.fastq.gz HL_CS16_21.trim_2P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719212.trim_2U.fastq.gz HL_CS16_21.trim_2U.fastq.gz

ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719213.trim_1P.fastq.gz HL_CS17_33.trim_1P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719213.trim_1U.fastq.gz HL_CS17_33.trim_1U.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719213.trim_2P.fastq.gz HL_CS17_33.trim_2P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719213.trim_2U.fastq.gz HL_CS17_33.trim_2U.fastq.gz

ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719214.trim_1P.fastq.gz HL_CS16_43.trim_1P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719214.trim_1U.fastq.gz HL_CS16_43.trim_1U.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719214.trim_2P.fastq.gz HL_CS16_43.trim_2P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719214.trim_2U.fastq.gz HL_CS16_43.trim_2U.fastq.gz

ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719241.trim_1P.fastq.gz HL_CS17_42.trim_1P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719241.trim_1U.fastq.gz HL_CS17_42.trim_1U.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719241.trim_2P.fastq.gz HL_CS17_42.trim_2P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719241.trim_2U.fastq.gz HL_CS17_42.trim_2U.fastq.gz

ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719242.trim_1P.fastq.gz HL_CS16_49.trim_1P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719242.trim_1U.fastq.gz HL_CS16_49.trim_1U.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719242.trim_2P.fastq.gz HL_CS16_49.trim_2P.fastq.gz
ln -s /proj/g2020008/nobackup/private/2_Eckalbar_2016/sel4/rna_seq_data/trimmed/sel4_SRR1719242.trim_2U.fastq.gz HL_CS16_49.trim_2U.fastq.gz

#Create scripts for quality check
cd /home/sarasl/git/GenomeAnalysis/
mkdir Scripts
cd Scripts
touch fastqc_wgs.sh
touch fastqc_rna_seq_raw.sh
touch fastqc_rna_seq_trimmed.sh
touch fastqc_HL_CS17_45.sh

#Quality check of given data
salloc -A g2020008 -p core -n 2 -t 02:00:00
module load bioinfo-tools
module load FastQC
cd git/GenomAnalysis/Scripts/
sh fastqc_wgs.sh
sh fastqc_rna_seq_raw.sh
sh fastqc_rna_seq_trimmed.sh

#Trim Raw data 
module load trimmomatic
java -jar $TRIMMOMATIC_HOME/trimmomatic.jar PE -trimlog rna_seq_trimLogFile HL_CS17_45.1.fastq.gz HL_CS17_45.2.fastq.gz HL_CS17_45.trimmed_1P.fastq.gz HL_CS17_45.trimmed_1U.fastq.gz HL_CS17_45.trimmed_2P.fastq.gz HL_CS17_45.trimmed_2U.fastq.gz ILLUMINACLIP:$TRIMMOMATIC_HOME/adapters/TruSeq3-PE.fa:2:30:10 LEADING:17 TRAILING:17

#Quality check trimmed data 
cd git/GenomAnalysis/Scripts/
touch fastqc_HL_CS17_45.sh
sh fastqc_HL_CS17_45.sh

#Genome assembly 
mkdir 2_genome_assembly
touch SOAPdenovo.config
nano SOAPdenovo.config
cd ../Scripts/
touch SOAPdenovo_batch_job.sh
nano SOAPdenovo_batch_job.sh
sbatch SOAPdenovo_batch_job.sh

#Evaluate assembly 
cd /home/sarasl/git/GenomeAnalysis/Data/
mkdir scaffold
cp /proj/g2020008/nobackup/private/2_Eckalbar_2016/additional_data/sel4_NW_015503979.fna.gz /home/sarasl/git/GenomeAnalysis/Data/scaffold
gunzip scaffold/sel4_NW_015503979.fna.gz

cd ../2_genome_assembly
mkdir Evaluation
salloc -A g2020008 -p core -n 1 -t 00:30:00 --reservation=g2020008_17
module load bioinfo-tools
module load MUMmer
nucmer -p Nucmer_contig /home/sarasl/git/GenomeAnalysis/Data/scaffold/sel4_NW_015503979.fna /home/sarasl/git/GenomeAnalysis/2_genome_assembly/SOAPdenovo_output_K49.contig

mkdir MUMmerplot_contig
cd MUMmerplot_contig
touch ../../../Scripts/MUMmer_contig_batch_job.sh
nano ../../../Scripts/MUMmer_contig_batch_job.sh
sbatch ../../../Scripts/MUMmer_contig_batch_job.sh

mkdir MUMmerplot_contig_100bp
cd MUMmerplot_contig_100bp
touch ../../../Scripts/MUMmer_contig_100bp_batch_job.sh
nano ../../../Scripts/MUMmer_contig__100bp_batch_job.sh
sbatch ../../../Scripts/MUMmer_contig_100bp_batch_job.sh

mkdir MUMmerplot_contig_1kb
cd MUMmerplot_contig_1kb
touch ../../../Scripts/MUMmer_contig_1kb_batch_job.sh
nano ../../../Scripts/MUMmer_contig_1kb_batch_job.sh
sbatch ../../../Scripts/MUMmer_contig_1kb_batch_job.sh

mkdir MUMmerplot_scafSeq_1kb
cd MUMmerplot_scafSeq_1kb
touch ../../../Scripts/MUMmer_scafSeq_1kb_batch_job.sh
nano ../../../Scripts/MUMmer_scafSeq_1kb_batch_job.sh
sbatch ../../../Scripts/MUMmer_scafSeq_1kb_batch_job.sh

mkdir MUMmerplot_scafSeq_1kb_-m
cd MUMmerplot_scafSeq_1kb_-m
touch ../../../Scripts/MUMmer_scafSeq_1kb_-m_batch_job.sh
nano ../../../Scripts/MUMmer_scafSeq_1kb_-m_batch_job.sh
sbatch ../../../Scripts/MUMmer_scafSeq_1kb_-m_batch_job.sh
#gave empty delta-filter file

mkdir MUMmerplot_scafSeq_1kb_layout_filter
cd MUMmerplot_scafSeq_1kb_-m
touch ../../../Scripts/MUMmer_scafSeq_1kb_layout_filter_batch_job.sh
nano ../../../Scripts/MUMmer_scafSeq_1kb_layout_filter_batch_job.sh
sbatch ../../../Scripts/MUMmer_scafSeq_1kb_layout_filter_batch_job.sh

# created pythonscript to remove short contigs
module load bioinfo-tools
python3 /home/sarasl/git/GenomeAnalysis/Scripts/remove_short_contigs.py  /home/sarasl/git/GenomeAnalysis/2_genome_assembly/SOAPdenovo_output_K49.contig

mv /home/sarasl/git/GenomeAnalysis/Scripts/remove_short_contigs.py Cleaned_files/
mv /home/sarasl/git/GenomeAnalysis/2_genome_assembly/SOAPdenovo_output_K49.contig Cleaned_files/
mv /home/sarasl/git/GenomeAnalysis/2_genome_assembly/SOAPdenovo_output_K49.scafSeq Cleaned_files/
python3 remove_short_contigs.py SOAPdenovo_output_K49.contig

mkdir 3_rna_assembly
cd 3_rna_assembly/
touch ../Scripts/bowtie_index_batch_job.sh
nano ../Scripts/bowtie_index_batch_job.sh
sbatch --reservation=g2020008_28 ../Scripts/bowtie_index_batch_job.sh

touch ../Scripts/tophat_batch_job
nano ../Scripts/tophat_batch_job
sbatch --reservation=g2020008_28 ../Scripts/tophat_batch_job

mkdir trinity
cd trinity/
touch ../../Scripts/trinity_batch_job.sh
nano ../../Scripts/trinity_batch_job.sh
sbatch --reservation=g2020008_29 ../../Scripts/trinity_batch_job.sh

cd ../
mkdir Evaluation
cd Evaluation
touch ../../Scripts/MUMmer_rna_batch_job.sh
nano ../../Scripts/MUMmer_rna_batch_job.sh
sbatch --reservation=g2020008_29 ../../Scripts/MUMmer_rna_batch_job.sh

module load bioinfo-tools
module load marker/3.01.1-beta
maker -CTL
nano maker_opts.ctl
	#changed:
	#genome=/home/sarasl/git/GenomeAnalysis/2_genome_assembly/Cleaned_files/clear_SOAPdenovo_output_K49.contig
	#est=/home/sarasl/git/GenomeAnalysis/3_rna_assembly/trinity_out_dir/Trinity-GG.fasta
	#est2genome=1
touch ../../Scripts/maker_batch_script.sh
nano ../../Scripts/maker_batch_script.sh
sbatch ../../Scripts/maker_batch_script.sh

cd clear_SOAPdenovo_output_K49.maker.output
module load bioinfo-tools
module load maker/3.01.1-beta
gff3_merge -d clear_SOAPdenovo_output_K49_master_datastore_index.log
maker2zff clear_SOAPdenovo_output_K49.all.gff
fathom genome.ann genome.dna -validate > snap_validate_output.txt
	#output: 24 genes, 24 OK, 15 warnings, 0 errors
cat snap_validate_output.txt | grep "warning"
	# 2554373: MODEL16 423 1578 2 - warnings(1): cds:incomplete
	# 2554761: MODEL10 1865 2032 1 + warnings(1): cds:incomplete
	# 2554827: MODEL8 665 1437 3 + warnings(1): cds:incomplete
	# 2554881: MODEL9 1507 1981 2 - warnings(1): cds:incomplete
	# 2555265: MODEL13 508 2444 2 - warnings(1): cds:incomplete
	# 2555313: MODEL11 450 1468 2 - warnings(1): cds:incomplete
	# 2555485: MODEL0 1132 3255 2 + warnings(1): cds:incomplete
	# 2555599: MODEL12 219 3223 12 + warnings(1): cds:incomplete
	# 2555613: MODEL17 1165 6486 10 - warnings(1): cds:incomplete
	# 2555645: MODEL21 650 7279 12 + warnings(1): cds:incomplete
	# 2555653: MODEL14 1902 4734 3 - warnings(1): cds:incomplete
	# 2555669: MODEL1 148 6973 5 + warnings(1): exon-1:short(4)
	# 2555695: MODEL2 4736 11341 7 - warnings(1): cds:incomplete
	# 2555705: MODEL5 5073 6544 2 + warnings(1): cds:incomplete
	# 2555705: MODEL6 7547 8290 2 + warnings(1): cds:incomplete
fathom genome.ann genome.dna -categorize 1000
fathom uni.ann uni.dna -export 1000 -plus 
forge export.ann export.dna
hmm-assembler.pl my_genome . > my_genome.hmm
	#changed:
	#snaphmm=/home/sarasl/git/GenomeAnalysis/4_annotation/Maker2/clear_SOAPdenovo_output_K49.maker.output/my_genome.hmm
	#est2genome=0 
sbatch ../../../Scripts/maker_batch_script.sh
	
#repeat step 2 & 3
gff3_merge -d clear_SOAPdenovo_output_K49_master_datastore_index.log
maker2zff clear_SOAPdenovo_output_K49.all.gff
fathom genome.ann genome.dna -categorize 1000
fathom uni.ann uni.dna -export 1000 -plus 
forge export.ann export.dna
hmm-assembler.pl my_genome . > my_genome.hmm
sbatch ../../../Scripts/maker_batch_script.sh

touch zff2augustus_gbk.pl
nano zff2augustus_gbk.pl
	#pasted in script from https://github.com/hyphaltip/genome-scripts/edit/master/gene_prediction/zff2augustus_gbk.pl
module load augustus
perl zff2augustus_gbk.pl > augustus.gbk













